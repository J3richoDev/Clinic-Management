{% extends 'base.html' %}
{% load static %}
{% load crispy_forms_tags %}
{% load widget_tweaks%}

{% block title %}Patient List{% endblock %}
{% block heading %}Patient List{% endblock %}

{% block content %}

{% if not request.user.is_superuser %}


<form method="get">
    <input type="text" name="q" placeholder="Search patients..." value="{{ request.GET.q }}">
    <button type="submit">Search</button>
    <a href="{% url 'add_patient' %}">Add Patient</a>
</form>


<div class="card w-full p-6 bg-base-100 shadow-xl mt-2 max-h-[600px] overflow-y-auto min-h-[300px]">

    <h2>Queue table</h2>

    <div class="relative overflow-x-auto rounded-lg">
      <table class="table w-full whitespace-no-wrap table-pin-rows table-pin-cols">
        <thead>
            <tr>
                <th>Name</th>
                <th>Role</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            {% for patient in patients %}
            <tr>
                <td>{{ patient.first_name }} {{ patient.last_name }}</td>
                <td>{{ patient.get_role_display }}</td>
                <td>
                    <a href="{% url 'patient_detail' patient.id %}">View</a>
                    <a href="{% url 'add_medical_record' patient.id %}">Add Medical Record</a>
                </td>
            </tr>
            {% empty %}
            <tr>
                <td colspan="3">No patients found.</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    </div>
</div>

{% endif %}




{% endblock %}

