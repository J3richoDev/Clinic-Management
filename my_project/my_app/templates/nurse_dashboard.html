<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nurse Dashboard</title>
</head>
<body>
    
    <nav style="background-color: #f8f9fa; padding: 10px; display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid #ddd;">
        <!-- Navigation Links -->
        <div style="display: flex; align-items: center;">
            <a href="{% url 'nurse_dashboard' %}" style="margin-right: 20px; text-decoration: none; color: #007bff;">Home</a>
            <a href="{% url 'queue' %}" style="margin-right: 20px; text-decoration: none; color: #007bff;">Queuing</a>
            <a href="{% url 'patient_list' %}" style="margin-right: 20px; text-decoration: none; color: #007bff;">Patients</a>
            <a href="{% url 'view_profile' %}" style="text-decoration: none; color: #007bff;">Profile</a>
        </div>

        <!-- Profile Picture -->
        <div style="display: flex; align-items: center;">
            <img src="{{ user.profile_picture.url }}" alt="Profile Picture" style="width: 40px; height: 40px; border-radius: 50%; margin-right: 10px;">
            <a href="{% url 'view_profile' %}" style="text-decoration: none; color: #007bff;">{{ user.full_name }}</a>
            <form action="{% url 'logout' %}" method="post" style="display: inline;">
        </div>
    </nav>

</form>

    <!-- New Section: Queue System -->
    <h2>Queue for Walk-In Patients</h2>
    <table>
        <thead>
            <tr>
                <th>Queue Number</th>
                <th>Transaction Type</th>
                <th>Patient Role</th>
                <th>Special Tag</th>
                <th>Transaction Time</th>
                <th>Status</th>
            </tr>
        </thead>
        <tbody>
            {% for ticket in tickets %}
            <tr>
                <td>{{ ticket.queue_number }}</td>
                <td>{{ ticket.get_transaction_type_display }}</td>
                <td>{{ ticket.get_role_display }}</td>
                <td>{{ ticket.get_special_tag_display }}</td>
                <td>{{ ticket.transaction_time_local|date:"Y-m-d H:i:s" }}</td>
                <td>
                    {% if ticket.label == "Being Served" %}
                        <span style="font-weight: bold; color: green;">Being Served</span>
                    {% elif ticket.label == "Next" %}
                        <span style="font-weight: bold; color: orange;">Next</span>
                    {% else %}
                        <span style="color: gray;">In Queue</span>
                    {% endif %}
                </td>
            </tr>
            {% empty %}
            <tr>
                <td colspan="6">No tickets in the queue</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    
    <!-- Add a Proceed button below the table -->
    {% if tickets %}
    <!-- Form action references the first ticket in the queue -->
    <form action="{% url 'kiosk:proceed_next_patient' tickets.0.id %}" method="post">
        {% csrf_token %}
        <button type="submit">Proceed</button>
    </form>
{% else %}
    <p>No patients in the queue.</p>
{% endif %}
    <a href="{% url 'add_patient' %}">Add Patient</a>

</body>
</html>
